<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

<head>
    <metal:javascriptslot fill-slot="javascript_head_slot">
        <script type="text/javascript" src="//dme0ih8comzn4.cloudfront.net/js/feather.js"></script>
        <script type="text/javascript" tal:content="view/javascript">
        // Aviary Feather settings
        </script>
        <script type="text/javascript">
            function launchEditor() {
                featherEditor.launch({
                    image: 'transform-image',
                    appendTo: 'content',
                    onLoad: function() {
                        launchEditor();
                    },
                    onSave: function(imageID, newURL) {
                        document.location = $('base').attr('href') + '/@@aviary_save?imageUrl=' + encodeURIComponent(newURL);
                    },
                    onError: function(errorObj) {
                        alert(errorObj.message);
                    }
                });
                return true;
            }
            $(document).ready(function() {
                $('#content-core input').click();
            });
        </script>
    </metal:javascriptslot>
</head>
<body>

<metal:main fill-slot="main" tal:define="image nocall:here;
                                         size python:here.getObjSize(here)">

    <h1 class="documentFirstHeading" tal:content="here/pretty_title_or_id">Title or id</h1>
    <div class="documentDescription" tal:content="here/Description">
        Description
    </div>

    <div id="content-core">

        <input type="button" value="Transform" i18n:attributes="value"
               onclick="launchEditor();" />

        <br />


        <img src="#" alt="" tal:replace="structure python:here.tag(scale='preview')" />
        <img src="#" alt="" tal:replace="structure python:here.tag(id='transform-image', style='display:none;')" />
    </div>

</metal:main>

</body>
</html>
