<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

<head>
    <metal:javascriptslot fill-slot="javascript_head_slot">
        <script type="text/javascript" src="http://feather.aviary.com/js/feather.js"></script>
        <script type="text/javascript" tal:content="view/javascript">
        // Aviary Feather settings
        </script>
        <script type="text/javascript">
            function launchEditor() {
                featherEditor.launch({
                    image: 'transform-image',
                    appendTo: 'visual-portal-wrapper',
                    onSave: function(imageID, newURL) {
                        document.location = $('base').attr('href') + '/@@aviary_save?imageUrl=' + encodeURIComponent(newURL);
                    },
                    onError: function(errorObj) {
                        alert(errorObj.message);
                    }

                });
                return false;
            }
        </script>
    </metal:javascriptslot>
</head>
<body>

<metal:main fill-slot="main" tal:define="image nocall:here;
                                         size python:here.getObjSize(here)">

    <h1 class="documentFirstHeading" tal:content="here/pretty_title_or_id">Title or id</h1>
    <div class="documentDescription" tal:content="here/Description">
        Description
    </div>

    <div id="content-core">

        <img src="#" alt="" tal:replace="structure python:here.tag(scale='preview')" />
        <br />

        <input type="button" value="Transform" i18n:attributes="value"
               onclick="launchEditor();" />

    </div>

    <div style="display: none;">
        <img src="#" alt="" tal:replace="structure python:here.tag(id='transform-image')" />
    </div>


</metal:main>

</body>
</html>
